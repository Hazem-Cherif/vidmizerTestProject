<ng-template #progress>
    <div class="divSpinner" *ngIf="!regionCharger">
        <mat-spinner color="accent"></mat-spinner>
    </div>
</ng-template>
<ng-container *ngIf="regionCharger" ; else progress>
    <div id="left" class="container ">
        <div class="row">
            <div id="left" class="col-sm-9 col-md-7 col-lg-5 mx-auto">
                <div class="card card-signin my-5">
                    <div class="card-body">
                        {{err}}
                        <br>
                        <h1 class="card-title text-center w-100 p-3 text-primary text-uppercase">Address Book Form</h1>
                        <form class="form-signin" [formGroup]="addressBookForm" (ngSubmit)="addContact()">
                            <div class="form-label-group">
                                <input type="text" id="inputFirstName" class="form-control" placeholder="First Name"
                                    formControlName="firstName">
                                <label for="inputFirstName">First Name</label>
                                <br>
                                <div class="alert alert-danger"
                                    *ngIf="addressBookForm.controls['firstName'].errors && addressBookForm.get('firstName').touched">
                                    <div *ngIf="addressBookForm.controls['firstName'].hasError('required')">First Name
                                        is required</div>
                                </div>
                            </div>

                            <div class="form-label-group">
                                <input type="text" id="inputLastName" class="form-control" placeholder="Last Name"
                                    formControlName="lastName">
                                <label for="inputLastName">Last Name</label>
                                <br>
                                <div class="alert alert-danger"
                                    *ngIf="addressBookForm.controls['lastName'].errors && addressBookForm.get('lastName').touched">
                                    <div *ngIf="addressBookForm.controls['lastName'].hasError('required')">Last Name is
                                        required</div>
                                </div>
                            </div>

                            <div class="form-label-group">
                                <input type="number" id="inputphoneNumbre" class="form-control" placeholder="phone Numbre"
                                    formControlName="phoneNumbre">
                                <label for="inputphoneNumbre">phone Numbre</label>
                                <br>
                                <div class="alert alert-danger"
                                    *ngIf="addressBookForm.controls['phoneNumbre'].errors && addressBookForm.get('phoneNumbre').touched">
                                    <div *ngIf="addressBookForm.controls['phoneNumbre'].hasError('required')">phone
                                        Numbre is required</div>

                                    <div *ngIf="addressBookForm.controls['phoneNumbre'].hasError('minlength')">phone
                                        Numbre length must be greater then 10</div>
                                </div>
                            </div>

                            <div class="form-label-group">
                                <select class="form-select" id="inputregion" name="region" formControlName="region" aria-placeholder="region"
                                    aria-label="Default select example">
                                    <label for="inputregion">region</label>
                                    <option selected *ngFor="let region of regions" [value]=region.nom>{{region.nom}}
                                    </option>

                                </select>


                            </div>
                            <button class="btn btn-lg btn-primary btn-block text-uppercase col-lg-5 " type="submit"
                                [disabled]="addressBookForm.invalid">Add Contact</button>



                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

</ng-container>

<div id="left" class="container ">
    <div class="row">
        <div id="left" class="col-sm-9 col-md-7 col-lg-5 mx-auto">
            <div class="card card-signin my-5">
                <div class="card-body">
                    <h1 class="card-title text-center w-100 p-3 text-primary text-uppercase">Address Book Form</h1>
                    <div class="search-hero ">
                        <input type="string" id="inputRecherche" class="search form-control col-lg-1"
                            placeholder="Search" [(ngModel)]="searchText">


                    </div>

                    
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">First Name</th>
                                <th scope="col">Last Names</th>
                                <th scope="col">Phone Numbre</th>
                                <th scope="col">Region</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let c of contacts; index as i">

                                <th scope="row">{{ i + 1 }}</th>
                                <td>{{c.firstName}}</td>
                                <td>{{c.lastName}}</td>
                                <td>{{ c.phoneNumbre }}</td>
                                <td>{{c.region}}</td>
                                <td> <button type="button" (click)="deleteContact(c.id)"
                                        class="btn btn-dark">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>